class ItcSimpleSlider{static PREFIX="itcss";static EL_WRAPPER=`${ItcSimpleSlider.PREFIX}__wrapper`;static EL_ITEM=`${ItcSimpleSlider.PREFIX}__item`;static EL_ITEM_ACTIVE=`${ItcSimpleSlider.PREFIX}__item_active`;static EL_ITEMS=`${ItcSimpleSlider.PREFIX}__items`;static EL_INDICATOR=`${ItcSimpleSlider.PREFIX}__indicator`;static EL_INDICATOR_ACTIVE=`${ItcSimpleSlider.PREFIX}__indicator_active`;static EL_INDICATORS=`${ItcSimpleSlider.PREFIX}__indicators`;static EL_CONTROL=`${ItcSimpleSlider.PREFIX}__btn`;static SWIPE_THRESHOLD=20;static TRANSITION_NONE="transition-none";static checkSupportPassiveEvents(){let t=!1;try{const e=Object.defineProperty({},"passive",{get(){t=!0}});window.addEventListener("testPassiveListener",null,e),window.removeEventListener("testPassiveListener",null,e)}catch(e){t=!1}return t}constructor(t,e){this._el="string"==typeof t?document.querySelector(t):t,this._elWrapper=this._el.querySelector(`.${this.constructor.EL_WRAPPER}`),this._elItems=this._el.querySelector(`.${this.constructor.EL_ITEMS}`),this._elListItem=this._el.querySelectorAll(`.${this.constructor.EL_ITEM}`),this._exOrderMin=0,this._exOrderMax=0,this._exItemMin=null,this._exItemMax=null,this._exTranslateMin=0,this._exTranslateMax=0,this._states=[],this._isBalancing=!1,this._direction="next",this._transform=0,this._clientRect=this._elWrapper.getBoundingClientRect(),this._supportResizeObserver=void 0!==window.ResizeObserver;const s=window.getComputedStyle(this._elItems);if(this._delay=Math.round(50*parseFloat(s.transitionDuration)),this._hasSwipeState=!1,this._swipeStartPosX=0,this._intervalId=null,this._config={loop:!0,autoplay:!1,interval:5e3,indicators:!0,swipe:!0,...e},this._elItems.dataset.translate="0",this._elListItem.forEach(((t,e)=>{t.dataset.order=`${e}`,t.dataset.index=`${e}`,t.dataset.translate="0",this._states.push(0===e?1:0)})),this._config.loop){const t=this._elListItem.length-1,e=-this._elListItem.length;this._elListItem[t].dataset.order="-1",this._elListItem[t].dataset.translate=""+-this._elListItem.length;const s=e*this._clientRect.width;this._elListItem[t].style.transform=`translate3D(${s}px, 0px, 0.1px)`}this._addIndicators(),this._elListIndicator=document.querySelectorAll(`.${this.constructor.EL_INDICATOR}`),this._updateExProperties(),this._changeActiveItems(),this._addEventListener(),this._autoplay()}_changeActiveItems(){this._states.forEach(((t,e)=>{t?this._elListItem[e].classList.add(this.constructor.EL_ITEM_ACTIVE):this._elListItem[e].classList.remove(this.constructor.EL_ITEM_ACTIVE),this._elListIndicator.length&&t?this._elListIndicator[e].classList.add(this.constructor.EL_INDICATOR_ACTIVE):this._elListIndicator.length&&!t&&this._elListIndicator[e].classList.remove(this.constructor.EL_INDICATOR_ACTIVE)})),this._el.dispatchEvent(new CustomEvent("change.itc.slider",{bubbles:!0}))}_move(){if(this._elItems.classList.remove(this.constructor.TRANSITION_NONE),"none"===this._direction){const t=this._transform*this._clientRect.width;return void(this._elItems.style.transform=`translate3D(${t}px, 0px, 0.1px)`)}if(!this._config.loop){const t=this._states[0]&&"prev"===this._direction,e=this._states[this._states.length-1]&&"next"===this._direction;if(t||e)return void this._autoplay("stop")}this._transform+="next"===this._direction?-1:1,"next"===this._direction?this._states=[...this._states.slice(-1),...this._states.slice(0,-1)]:"prev"===this._direction&&(this._states=[...this._states.slice(1),...this._states.slice(0,1)]),this._elItems.dataset.translate=this._transform;const t=this._transform*this._clientRect.width;this._elItems.style.transform=`translate3D(${t}px, 0px, 0.1px)`,this._elItems.dispatchEvent(new CustomEvent("moving.itc.slider",{bubbles:!0})),this._changeActiveItems(),this._isBalancing||(this._isBalancing=!0,window.requestAnimationFrame(this._balanceItems.bind(this)))}_moveTo(t){const e=this._states.indexOf(1);this._direction=t>e?"next":"prev";for(let s=0;s<Math.abs(t-e);s++)this._move()}_autoplay(t){if(this._config.autoplay)return"stop"===t?(clearInterval(this._intervalId),void(this._intervalId=null)):void(null===this._intervalId&&(this._intervalId=setInterval((()=>{this._direction="next",this._move()}),this._config.interval)))}_addIndicators(){if(this._el.querySelector(`.${this.constructor.EL_INDICATORS}`)||!this._config.indicators)return;let t="";for(let e=0,{length:s}=this._elListItem;e<s;e++)t+=`<li class="${this.constructor.EL_INDICATOR}" data-slide-to="${e}"></li>`;const e=`<ol class="${this.constructor.EL_INDICATORS}">${t}</ol>`;this._el.insertAdjacentHTML("beforeend",e)}_updateExProperties(){const t=Object.values(this._elListItem).map((t=>t)),e=t.map((t=>Number(t.dataset.order)));this._exOrderMin=Math.min(...e),this._exOrderMax=Math.max(...e);const s=e.indexOf(this._exOrderMin),i=e.indexOf(this._exOrderMax);this._exItemMin=t[s],this._exItemMax=t[i],this._exTranslateMin=Number(this._exItemMin.dataset.translate),this._exTranslateMax=Number(this._exItemMax.dataset.translate)}_balanceItems(){if(this._isBalancing){if("next"===this._direction){if(this._exItemMin.getBoundingClientRect().right<this._clientRect.left-this._clientRect.width/2){this._exItemMin.dataset.order=`${this._exOrderMin+this._elListItem.length}`,this._exItemMin.dataset.translate=`${this._exTranslateMin+this._elListItem.length}`;const t=(this._exTranslateMin+this._elListItem.length)*this._clientRect.width;this._exItemMin.style.transform=`translate3D(${t}px, 0px, 0.1px)`,this._updateExProperties()}}else{if(this._exItemMax.getBoundingClientRect().left>this._clientRect.right+this._clientRect.width/2){this._exItemMax.dataset.order=""+(this._exOrderMax-this._elListItem.length),this._exItemMax.dataset.translate=""+(this._exTranslateMax-this._elListItem.length);const t=(this._exTranslateMax-this._elListItem.length)*this._clientRect.width;this._exItemMax.style.transform=`translate3D(${t}px, 0px, 0.1px)`,this._updateExProperties()}}window.setTimeout((()=>{window.requestAnimationFrame(this._balanceItems.bind(this))}),this._delay)}}_addEventListener(){const t=t=>{if(this._autoplay("stop"),t.target.closest(`.${this.constructor.EL_CONTROL}`))return;const e=0===t.type.search("touch")?t.touches[0]:t;this._swipeStartPosX=e.clientX,this._swipeStartPosY=e.clientY,this._hasSwipeState=!0,this._hasSwiping=!1},e=t=>{if(!this._hasSwipeState)return;const e=0===t.type.search("touch")?t.touches[0]:t;let s=this._swipeStartPosX-e.clientX;const i=this._swipeStartPosY-e.clientY;if(!this._hasSwiping){if(Math.abs(i)>Math.abs(s)||0===Math.abs(s))return void(this._hasSwipeState=!1);this._hasSwiping=!0}if(t.preventDefault(),!this._config.loop){const t=this._states[0]&&s<=0,e=this._states[this._states.length-1]&&s>=0;(t||e)&&(s/=4)}this._elItems.classList.add(this.constructor.TRANSITION_NONE);const a=this._transform*this._clientRect.width-s;this._elItems.style.transform=`translate3D(${a}px, 0px, 0.1px)`},s=t=>{if(!this._hasSwipeState)return;const e=0===t.type.search("touch")?t.changedTouches[0]:t;let s=this._swipeStartPosX-e.clientX;if(0===s)return void(this._hasSwipeState=!1);if(!this._config.loop){const t=this._states[0]&&s<=0,e=this._states[this._states.length-1]&&s>=0;(t||e)&&(s=0)}const i=s/this._clientRect.width*100;this._elItems.classList.remove(this.constructor.TRANSITION_NONE),i>this.constructor.SWIPE_THRESHOLD?(this._direction="next",this._move()):i<-this.constructor.SWIPE_THRESHOLD?(this._direction="prev",this._move()):(this._direction="none",this._move()),this._hasSwipeState=!1,this._autoplay()};if(this._el.addEventListener("click",(t=>{const e=t.target;if(this._autoplay("stop"),e.classList.contains(this.constructor.EL_CONTROL))t.preventDefault(),this._direction=e.dataset.slide,this._move();else if(e.dataset.slideTo){t.preventDefault();const s=parseInt(e.dataset.slideTo,10);this._moveTo(s)}this._autoplay()})),this._config.loop&&this._elItems.addEventListener("transitionend",(()=>{this._isBalancing=!1})),this._el.addEventListener("mouseenter",(()=>{this._autoplay("stop")})),this._el.addEventListener("mouseleave",(()=>{this._autoplay()})),this._config.swipe){const i=!!this.constructor.checkSupportPassiveEvents()&&{passive:!1};this._el.addEventListener("touchstart",t,i),this._el.addEventListener("touchmove",e,i),this._el.addEventListener("mousedown",t),this._el.addEventListener("mousemove",e),document.addEventListener("touchend",s),document.addEventListener("mouseup",s),document.addEventListener("mouseout",s)}if(this._el.addEventListener("dragstart",(t=>{t.preventDefault()})),document.addEventListener("visibilitychange",(()=>{"visible"===document.visibilityState&&this._config.loop?this._autoplay():this._autoplay("stop")})),this._supportResizeObserver){new ResizeObserver((t=>{const{contentRect:e}=t[0];if(Math.round(10*this._clientRect.width)===Math.round(10*e.width))return;this._clientRect=e;const s=e.width*Number(this._elItems.dataset.translate);this.reset(s,!0),this._autoplay()})).observe(this._elWrapper)}}reset(t=0,e=!1){if(this._autoplay("stop"),this._elItems.classList.add(this.constructor.TRANSITION_NONE),this._elItems.style.transform=`translate3D(${t}px, 0px, 0.1px)`,this._elListItem.forEach((t=>{const s=e?Number(t.dataset.translate)*this._clientRect.width:0;t.style.transform=`translate3D(${s}px, 0px, 0.1px)`})),!e){if(this._transform=0,this._states=[],this._elItems.dataset.translate="0",this._elListItem=this._el.querySelectorAll(`.${this.constructor.EL_ITEM}`),this._elListItem.forEach(((t,e)=>{t.dataset.order=`${e}`,t.dataset.index=`${e}`,t.dataset.translate="0",this._states.push(0===e?1:0)})),this._config.loop){const t=this._elListItem.length-1,e=-this._elListItem.length;this._elListItem[t].dataset.order="-1",this._elListItem[t].dataset.translate=""+-this._elListItem.length;const s=e*this._clientRect.width;this._elListItem[t].style.transform=`translate3D(${s}px, 0px, 0.1px)`}this._el.querySelector(`.${this.constructor.EL_INDICATORS}`).remove(),this._addIndicators(),this._elListIndicator=document.querySelectorAll(`.${this.constructor.EL_INDICATOR}`),this._updateExProperties(),this._changeActiveItems()}this._autoplay()}next(){this._direction="next",this._move()}prev(){this._direction="prev",this._move()}autoplay(){this._autoplay("stop")}moveTo(t){this._moveTo(t)}}